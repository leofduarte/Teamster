import{r as l,j as t,Y as J,a as F}from"./app-DA6yD-bg.js";import{M as P}from"./index-DK_DB61g.js";import{A as E,a as Q,b as T}from"./AddRadioForm-CZ-LwVMG.js";import{B as u}from"./button-Czat_LeM.js";import{u as R}from"./use-toast-DSZ2X8Ft.js";import{Layout as D}from"./Layout-CD6lmAmp.js";import{M as V}from"./Modal-Q1vF_rf7.js";import{T as b,C as A,R as v}from"./Radio_cp-npa-mGGS.js";import"./index-0yB0lKw6.js";import"./input-BMchtnkz.js";import"./utils-Baa09YAL.js";import"./textarea-bNjw3qJ2.js";import"./index.es-C4Hz4JyV.js";import"./index-DTzn02tC.js";import"./separator-D5br-jdY.js";import"./index-BSvPNBtZ.js";import"./radio-group-ao2XUvb9.js";import"./index-wyKmaqcT.js";import"./index-DjDCE-CF.js";import"./index-D2R9fagv.js";import"./index-gIoNW1Kd.js";import"./index-DKKbawXw.js";import"./circle-DvhWujGC.js";import"./createLucideIcon-TB6UWrdR.js";import"./logo-teamster-DKsO-BHU.js";import"./index-CNbTJdn3.js";import"./transition-CHIl-Fii.js";import"./label-DJGv7VYA.js";import"./checkbox-DteTE1QY.js";import"./index-DUFVU-Ky.js";import"./index-DgaNj54m.js";import"./index-DzzVjFRl.js";const As=({newquestionnaire_id:w})=>{const[y,h]=l.useState(!1),[d,f]=l.useState(null),[i,c]=l.useState([]),[N,W]=l.useState(null),[I,C]=l.useState(null),[r,B]=l.useState(null),[O,j]=l.useState(!1),{toast:S}=R();console.log(w);const n=(s,o)=>{c(e=>e.map(a=>a.id===s?{...a,value:o}:a))},_=s=>{const o=Math.random().toString(36).substr(2,9);f({id:o,type:s,label:"",value:"",placeholder:"",tooltip:"",description:"",isFetched:!1}),h(!0)},g=s=>{c(o=>o.filter(e=>e.id!==s))},m=s=>{c(o=>{const e=o.findIndex(a=>a.id===s.id);return e!==-1?[...o.slice(0,e),s,...o.slice(e+1)]:o}),h(!1)},k=async s=>{s.preventDefault(),console.log("Form Submitted");try{const o=[...i,...r].map(a=>({...a,options:Array.isArray(a.options)?a.options:[a.options],is_mandatory:a.is_mandatory||!1})),e=await F.post("/api/v1/addquestions",{items:o,questionnaire_id:w,is_mandatory:!0});console.log("Added Questions:",e),S({variant:"success",title:"Success!",description:`${e.data.message}`})}catch(o){(o.response.status===422||o.response.status===400)&&(C("Please fill out the Input."),S({variant:"destructive",title:"Error!",description:`An error occurred while adding the questionnaire. ${I}`})),console.error(o)}},M=()=>{j(!0)};return l.useEffect(()=>{(async()=>{try{const e=(await F.post("/api/v1/getquestions",{questionnaire_id:1})).data.questions.map(a=>({...a,value:a.type==="checkbox"?[]:"",isFetched:!0,is_mandatory:1}));B(e)}catch(o){console.error("Failed to fetch questions:",o)}})()},[]),l.useEffect(()=>{console.log(i),console.log(r)},[i,r]),l.useEffect(()=>{N===null&&C("Please fill out this field.")},[N]),t.jsx("div",{children:t.jsxs(D,{sidebar:t.jsx("div",{className:"flex items-center justify-center h-screen w-full",children:t.jsx(P,{handleAddItem:_})}),children:[t.jsx(J,{title:"Formulário de Feedback"}),t.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8 pt-12 bg-red-500",children:t.jsx("div",{className:"overflow-hidden",children:t.jsxs("div",{className:"p-6 text-gray-900",children:[t.jsx("h1",{className:"text-3xl font-bold text-black",children:"Formulário de Feedback"}),t.jsxs("div",{className:"my-6 flex flex-col justify-between",children:[t.jsx("h2",{className:"text-2xl font-serif uppercase",children:"Está na hora de analisar resultados"}),t.jsx("p",{className:"text-gray-500",children:"Pergunte aos seus colaboradores o que pensam sobre a atividade"}),t.jsxs("form",{onSubmit:k,className:"flex-grow",children:[r&&r.map((s,o)=>t.jsxs("div",{className:"my-4 p-4 min-h-fit rounded-xl gap-4 flex flex-col shadow-lg",children:[s.type==="text"&&t.jsx(b,{id:s.id,item:s,options:s.options,showButtons:!s.is_mandatory,onInputChange:e=>n(s.id,e.target.value)}),s.type==="checkbox"&&t.jsx(A,{id:s.id,item:s,options:s.options,showButtons:!s.is_mandatory,handleUpdateItem:m,onInputChange:e=>n(s.id,e?"1":"0")}),s.type==="radio"&&t.jsx(v,{id:s.id,item:s,options:Array.isArray(s.options)?s.options:[s.options],showButtons:!s.is_mandatory,onInputChange:e=>{const p=(Array.isArray(JSON.parse(s.options))?JSON.parse(s.options):[JSON.parse(s.options)]).find(x=>x.id===e);n(s.id,{id:p.id,label:p.label})}})]},o)),d&&d.type==="text"&&t.jsx(E,{isModalOpen:y,setIsModalOpen:h,currentItem:d,setCurrentItem:f,handleUpdateItem:m,items:i,setItems:c,handleDeleteItem:g,showButtons:!r.is_mandatory}),d&&d.type==="checkbox"&&t.jsx(Q,{isModalOpen:y,setIsModalOpen:h,currentItem:d,setCurrentItem:f,handleUpdateItem:m,items:i,setItems:c,handleDeleteItem:g,handleInputChange:n,showButtons:!r.is_mandatory}),d&&d.type==="radio"&&t.jsx(T,{isModalOpen:y,setIsModalOpen:h,currentItem:d,setCurrentItem:f,handleUpdateItem:m,items:i,setItems:c,handleDeleteItem:g,showButtons:!r.is_mandatory}),(i&&i.length>0||r&&r.length>0)&&t.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[t.jsx(u,{variant:"outline",onClick:"teste",children:"Voltar"}),t.jsx(u,{variant:"outline",onClick:M,children:"Pré-Visualizar"}),t.jsx(u,{type:"submit",children:"Prosseguir"})]})]})]}),t.jsx(V,{show:O,onClose:()=>j(!1),closeable:!1,children:t.jsxs("div",{className:"p-4 min-h-full bg-[#F8F7FC]",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Pré-Visualização do Formulário"}),r&&r.map((s,o)=>t.jsxs("div",{className:"my-4 bg-white p-4 min-h-fit rounded-xl gap-4 flex flex-col shadow-lg",children:[s.type==="text"&&t.jsx(b,{id:s.id,item:s,options:s.options,showButtons:!1,onInputChange:e=>n(s.id,e.target.value)}),s.type==="checkbox"&&t.jsx(A,{id:s.id,item:s,options:s.options,showButtons:!1,handleUpdateItem:m,onInputChange:e=>n(s.id,e?"1":"0")}),s.type==="radio"&&t.jsx(v,{id:s.id,item:s,options:Array.isArray(s.options)?s.options:[s.options],showButtons:!1,onInputChange:e=>{const p=(Array.isArray(JSON.parse(s.options))?JSON.parse(s.options):[JSON.parse(s.options)]).find(x=>x.id===e);n(s.id,{id:p.id,label:p.label})}})]},o)),i&&i.map((s,o)=>t.jsxs("div",{className:"my-4 bg-white p-4 min-h-fit rounded-xl gap-4 flex flex-col shadow-lg",children:[s.type==="text"&&t.jsx(b,{id:s.id,item:s,options:s.options,showButtons:!1,onInputChange:e=>n(s.id,e.target.value)}),s.type==="checkbox"&&t.jsx(A,{id:s.id,item:s,options:s.options,showButtons:!1,handleUpdateItem:m,onInputChange:e=>n(s.id,e?"1":"0")}),s.type==="radio"&&t.jsx(v,{id:s.id,item:s,options:Array.isArray(s.options)?s.options:[s.options],showButtons:!1,onInputChange:e=>{const p=(Array.isArray(JSON.parse(s.options))?JSON.parse(s.options):[JSON.parse(s.options)]).find(x=>x.id===e);n(s.id,{id:p.id,label:p.label})}})]},o)),t.jsx("div",{className:"flex justify-end",children:t.jsx(u,{variant:"destructive",onClick:()=>j(!1),children:"Fechar"})})]})})]})})})]})})};export{As as default};
