import{r as c,j as e,Y as K}from"./app-DA6yD-bg.js";import{u as X,a as Z,M as V,D as q,S as ee,v as te,b as se,c as ae,P as oe,d as ne}from"./index-DK_DB61g.js";import{B as y}from"./button-Czat_LeM.js";import{I as g}from"./input-BMchtnkz.js";import{Layout as le}from"./Layout-CD6lmAmp.js";import{C as O,T as D,R as M}from"./Radio_cp-npa-mGGS.js";import{t as F}from"./use-toast-DSZ2X8Ft.js";import{F as R}from"./index.es-C4Hz4JyV.js";import{n as ie,j as re}from"./index-DTzn02tC.js";import{S as de}from"./separator-D5br-jdY.js";import{T as B}from"./textarea-bNjw3qJ2.js";import"./label-DJGv7VYA.js";import"./checkbox-DteTE1QY.js";import{R as ce,a as pe}from"./radio-group-ao2XUvb9.js";import"./index-0yB0lKw6.js";import"./utils-Baa09YAL.js";import"./logo-teamster-DKsO-BHU.js";import"./index-CNbTJdn3.js";import"./index-BSvPNBtZ.js";import"./index-wyKmaqcT.js";import"./index-DjDCE-CF.js";import"./index-DUFVU-Ky.js";import"./index-gIoNW1Kd.js";import"./index-DgaNj54m.js";import"./createLucideIcon-TB6UWrdR.js";import"./index-DKKbawXw.js";import"./index-DzzVjFRl.js";import"./index-D2R9fagv.js";import"./circle-DvhWujGC.js";const xe=({item:j,onSubmit:u})=>{const[s,p]=c.useState(j),[i,h]=c.useState(""),x=n=>{n.preventDefault(),s!=null&&s.label?u(s):h("Please enter a label for the checkbox.")};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:x,children:[e.jsxs("label",{className:"text-black",children:["Label:",e.jsx(g,{type:"text",value:s.label,onChange:n=>p({...s,label:n.target.value})})]}),e.jsxs("label",{className:"text-black",children:["Tooltip:",e.jsx(g,{className:"block text-black",type:"text",value:s.tooltip,onChange:n=>p({...s,tooltip:n.target.value})})]}),e.jsxs("label",{className:"text-black",children:["Description:",e.jsx(B,{className:"block text-black",value:s.description,onChange:n=>p({...s,description:n.target.value})})]}),i&&e.jsx("p",{className:"text-red-500",children:i}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"button",onClick:x,className:"mt-4",children:"Save"})})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-black text-center text-xl",children:"Preview"}),s&&e.jsx(O,{showButtons:!1,item:s,id:s.id,onInputChange:()=>{},setNodeRef:()=>{},attributes:{},listeners:{},handle:()=>{}})]})]})},me=({item:j,onSubmit:u})=>{const[s,p]=c.useState(j),[i,h]=c.useState(""),x=n=>{n.preventDefault(),s!=null&&s.label?u(s):h("Please enter a label for the checkbox.")};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:x,children:[e.jsxs("label",{className:"text-black",children:["Label:",e.jsx(g,{className:"block text-black",type:"text",value:s.label,onChange:n=>p({...s,label:n.target.value})})]}),e.jsxs("label",{className:"text-black",children:["Placeholder:",e.jsx(g,{className:"block text-black",type:"text",value:s.placeholder,onChange:n=>p({...s,placeholder:n.target.value})})]}),e.jsxs("label",{className:"text-black",children:["Tooltip:",e.jsx(g,{className:"block text-black",type:"text",value:s.tooltip,onChange:n=>p({...s,tooltip:n.target.value})})]}),e.jsxs("label",{className:"text-black",children:["Description:",e.jsx(B,{className:"block text-black",value:s.description,onChange:n=>p({...s,description:n.target.value})})]}),i&&e.jsx("p",{className:"text-red-500",children:i}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"button",onClick:x,className:"mt-4",children:"Save"})})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-black text-center text-xl",children:"Preview"}),s&&e.jsx(D,{onEditItem:()=>{},item:s,id:s.id,onInputChange:()=>{},setNodeRef:()=>{},attributes:{},listeners:{},handle:()=>{}})]})]})},he=({item:j,onSubmit:u})=>{const[s,p]=c.useState(null),[i,h]=c.useState("");c.useEffect(()=>{var d;if(j){let r=j;(d=r==null?void 0:r.options)!=null&&d.length||(r.options=[{id:"option-1",label:""},{id:"option-2",label:""},{id:"option-3",label:""},{id:"option-4",label:""}]),console.log("temp",r),p(r)}},[j]);const x=d=>{if(d.preventDefault(),s!=null&&s.label){let r=s;r.options=r.options.filter(m=>m.label!==""),u(r)}else h("Please enter a label for the checkbox.")},n=d=>{var m;d.preventDefault();const r={id:`option-${((m=s==null?void 0:s.options)==null?void 0:m.length)+1}`,label:""};p(f=>({...f,options:[...f==null?void 0:f.options,r]}))},N=(d,r)=>{p(m=>({...m,options:m.options.map(f=>f.id===d?{...f,label:r}:f)}))},A=d=>{p(r=>({...r,options:r.options.filter(m=>m.id!==d)}))};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:x,children:[e.jsxs(ce,{defaultValue:"option-one",className:"text-black",children:[e.jsx(g,{type:"text",id:"label",placeholder:"Insert question here",className:"text-black",onChange:d=>p(r=>({...r,label:d.target.value})),value:s==null?void 0:s.label}),Array.isArray(s==null?void 0:s.options)&&s.options.map(d=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{value:d.id,id:d.id}),e.jsx(g,{type:"text",value:d.label,onChange:r=>N(d.id,r.target.value),placeholder:"Enter option label"}),e.jsx(y,{onClick:()=>A(d.id),children:e.jsx(R,{icon:ie})})]},d.id))]}),e.jsx(y,{type:"button",onClick:n,children:"Add Option"}),i&&e.jsx("p",{className:"text-red-500",children:i}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"button",onClick:x,className:"mt-4",children:"Save"})})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-black text-center text-xl",children:"Preview"}),s&&e.jsx(M,{onEditItem:()=>{},item:s,id:s.id,onInputChange:()=>{},setNodeRef:()=>{},attributes:{},listeners:{},handle:()=>{}})]})]})},Ue=({questionnaire:j,questions:u})=>{const[s,p]=c.useState(!1),[i,h]=c.useState(null),[x,n]=c.useState([]),[N,A]=c.useState(j.id),[d,r]=c.useState(null),[m,f]=c.useState([]);c.useState(!1);const[C,T]=c.useState(!1),[P,$]=c.useState(""),[ue,G]=c.useState(""),[be,Q]=c.useState((i==null?void 0:i.options)||[{id:"option-1",label:""},{id:"option-2",label:""},{id:"option-3",label:""},{id:"option-4",label:""}]),S=(t,a)=>{n(o=>o.map(l=>l.id===t?{...l,value:a}:l))},L=t=>{const a=Math.random().toString(36).substr(2,9);p(!0),h({id:a,type:t,label:"",value:"",placeholder:"",tooltip:"",description:"",isFetched:!1})},v=t=>{n(a=>a.filter(o=>o.id!==t))},J=t=>{n(a=>{const o=a.findIndex(l=>l.id===t.id);return o!==-1?[...a.slice(0,o),t,...a.slice(o+1)]:a}),p(!1)},_=async t=>{t.preventDefault();try{const a=[...x,...m].map(l=>{var b;return{...l,options:(b=l==null?void 0:l.options)!=null&&b.length?l.options:[],is_mandatory:!!(l!=null&&l.is_mandatory)}});console.log(a.filter(l=>!l.is_mandatory));const o=await axios.post("/api/v1/addquestions",{items:a.filter(l=>!l.is_mandatory),questionnaire_id:N});F({variant:"success",title:"Success!",description:`${o.data.message}`})}catch(a){console.log(a),(a.response.status===422||a.response.status===400)&&(r("Please fill out the Input."),F({variant:"destructive",title:"Error!",description:`An error occurred while adding the questionnaire. ${d}`})),console.error(a)}},I=t=>{const a=x.find(o=>o.id===t)||u.find(o=>o.id===t);a?(h(a),p(!0)):console.error(`Item with id ${t} not found in items or questions array`)},z=()=>{window.history.back()};c.useEffect(()=>{if(u){const t=u.filter(o=>o.is_mandatory),a=u.filter(o=>!o.is_mandatory);n(a),f(t)}},[u]),c.useEffect(()=>{N===null&&r("Please fill out this field.")},[N]),c.useEffect(()=>{console.log("currentItem",i)},[i]);const H=X(oe,{activationConstraint:{delay:250,tolerance:5}}),U=Z(H),W=t=>{const{active:a,over:o}=t;a&&o&&a.id!==o.id&&n(l=>{const b=l.findIndex(k=>k&&k.id===a.id),E=l.findIndex(k=>k&&k.id===o.id);return ne(l,b,E)})},Y=async t=>{if(!t)return null;const a=await axios.post(`/api/v1/${t.type}`,{askAPI:P});if(t.type==="text")h({...i,tooltip:a.data.tooltip,placeholder:a.data.placeholder,description:a.data.description,label:a.data.label});else if(t.type==="checkbox")h({...i,tooltip:a.data.tooltip,description:a.data.description,label:a.data.label});else if(t.type==="radio"){const o=Array.isArray(a.data.options)?a.data.options.map((l,b)=>({id:`option-${b+1}`,label:l})):[];h({...i,label:a.data.label||"",options:o}),Q(o)}G(a.data)},w=t=>{console.log("handleModalSubmit",t);const a=x.findIndex(o=>o.id===t.id);n(a!==-1?o=>o.map((l,b)=>b===a?t:l):o=>[...o,t]),p(!1),h(null)};return e.jsx("div",{children:e.jsxs(le,{sidebar:e.jsx("div",{className:"flex items-center justify-center h-screen w-full",children:e.jsx(V,{handleAddItem:L})}),children:[e.jsx(K,{title:"Formulário de Feedback"}),e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8 pt-12",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsx("h1",{className:"text-3xl font-bold text-black",children:"Formulário de Feedback"}),e.jsxs("div",{className:"my-6 flex flex-col justify-between",children:[e.jsx("h2",{className:"text-2xl font-serif uppercase",children:"Está na hora de analisar resultados"}),e.jsx("p",{className:"text-gray-500",children:"Pergunte aos seus colaboradores o que pensam sobre a atividade"}),e.jsxs("form",{onSubmit:_,className:"flex-grow",children:[m&&m.map((t,a)=>e.jsxs("div",{className:"my-4 bg-white p-4 min-h-fit rounded-xl gap-4 flex flex-col shadow-lg",children:[t.type==="text"&&e.jsx(D,{id:t.id,item:t,options:t.options,showGrab:!t.is_mandatory,showButtons:!t.is_mandatory,onInputChange:o=>S(t.id,o.target.value),onEditItem:I,handleDeleteItem:v}),t.type==="checkbox"&&e.jsx(O,{id:t.id,item:t,showGrab:!t.is_mandatory,options:t.options,showButtons:!t.is_mandatory,handleUpdateItem:J,onInputChange:o=>S(t.id,o?"1":"0"),onEditItem:I,handleDeleteItem:v}),t.type==="radio"&&e.jsx(M,{id:t.id,item:t,options:Array.isArray(t.options)?t.options:[t.options],showGrab:!t.is_mandatory,showButtons:!t.is_mandatory,onInputChange:o=>{const b=(Array.isArray(JSON.parse(t.options))?JSON.parse(t.options):[JSON.parse(t.options)]).find(E=>E.id===o);S(t.id,{id:b.id,label:b.label})},onEditItem:I,handleDeleteItem:v})]},a)),x&&x.length?e.jsx(q,{sensors:U,onDragEnd:W,children:e.jsx(ee,{items:x.filter(Boolean).map(t=>t.id),strategy:te,children:x.map(t=>t&&e.jsx(se,{id:t.id,item:t,className:"m-4",onInputChange:S,onEditItem:I,handleDeleteItem:v},t.id))})}):void 0,e.jsxs(ae,{ariaHideApp:!1,isOpen:s,onRequestClose:()=>p(!1),appElement:document.getElementById("root"),children:[e.jsx("h2",{className:"text-center text-xl text-black",children:"Configure Input"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("div",{className:"flex gap-2",children:e.jsxs(y,{onClick:()=>T(t=>!t),className:"z-10 transition-all duration-300 ease-in-out flex items-center",variant:"generate",style:{width:C?"40px":"auto"},children:[e.jsx(R,{className:"text-white",icon:re}),e.jsx("span",{className:`text-white overflow-hidden transition-all duration-300 ease-in-out ${C?"w-0 opacity-0":"w-auto opacity-100"}`,children:"Generate"})]})}),e.jsxs("div",{className:`absolute left-0 flex items-center transition-all duration-300 ease-in-out ${C?"translate-x-[44px] opacity-100":"translate-x-0 opacity-0 pointer-events-none"}`,children:[e.jsx(g,{type:"text",name:"askAPI",id:"askAPI",value:P,placeholder:"Enter a description of the question you need, and our AI will help you!",onChange:t=>$(t.target.value),className:"w-full mr-2"}),e.jsx(y,{variant:"outline",onClick:()=>Y(i),children:"Ask"})]})]}),e.jsx(de,{className:"my-8"}),i&&e.jsxs(e.Fragment,{children:[i.type==="text"&&e.jsx(me,{item:i,onSubmit:w}),i.type==="checkbox"&&e.jsx(xe,{item:i,onSubmit:w}),i.type==="radio"&&e.jsx(he,{item:i,onSubmit:w})]})]})]})]}),(x&&x.length>0||m&&m.length>0)&&e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(y,{variant:"outline",onClick:()=>{z(),console.log("Button clicked")},children:"Voltar"}),e.jsx(y,{type:"button",onClick:_,children:"Guardar"})]})]})})})]})})};export{Ue as default};
